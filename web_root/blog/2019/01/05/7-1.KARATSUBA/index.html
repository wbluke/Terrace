<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"><link rel="icon" href="/favicon.ico" type="image/x-icon"><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/styles/default.min.css"><script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><title> | Luke's Note</title><link href="/css/app.2ad29d68.css" rel="preload" as="style"><link href="/css/chunk-vendors.bad0137f.css" rel="preload" as="style"><link href="/js/app.b8edd235.js" rel="preload" as="script"><link href="/js/chunk-vendors.708a92f7.js" rel="preload" as="script"><link href="/css/chunk-vendors.bad0137f.css" rel="stylesheet"><link href="/css/app.2ad29d68.css" rel="stylesheet"><meta charset="utf-8" data-vue-meta="true"><meta property="og:image" content="https://wbluke.com/img/about.f9a09115.jpeg" data-vmid="og:image" data-vue-meta="true"><meta property="og:title" content="7-1.KARATSUBA | Luke's Note" data-vmid="og:title" data-vue-meta="true"><meta property="og:description" content="Thank you for reading my article ğŸ¦Š" data-vmid="og:description" data-vue-meta="true"></head><body><noscript><strong>We're sorry but home doesn't work properly without JavaScript enabled. Please enable it to continue.</strong></noscript><div id="app"><div id="site-title"><a href="/" class="page_title router-link-active"><h1><img id="site-logo" src="/img/favicon.4eb5b8a7.png" width="24" height="24">
        Luke's Note
      </h1></a></div><div class="menu effect"><ul><li><a href="/" class="router-link-active">About</a></li><li><a href="/blog/" class="router-link-active">Blog</a></li><li><a href="/insight/" class="">Insight</a></li></ul></div><p><div data-v-210f1d5a="" id="blog"><div data-v-210f1d5a="" id="blog-contents"><article data-v-210f1d5a=""><div data-v-210f1d5a="" class="inner-title-container"><h1 data-v-210f1d5a=""><a data-v-210f1d5a="" href="http://wbluke.com/blog/2019/01/05/7-1.KARATSUBA/" id="inner-title">[ì•Œê³ ë¦¬ì¦˜] 7-1. KARATSUBA (ì¹´ë¼ì¸ ë°” ì•Œê³ ë¦¬ì¦˜)</a></h1><p data-v-210f1d5a="" class="meta">2019 / 01 / 05</p></div><div data-v-210f1d5a="" id="article-content"><h1 id="ì•Œê³ ë¦¬ì¦˜-7-1.-karatsuba-ì¹´ë¼ì¸ ë°”-ì•Œê³ ë¦¬ì¦˜" style="display: none;">[ì•Œê³ ë¦¬ì¦˜] 7-1. KARATSUBA (ì¹´ë¼ì¸ ë°” ì•Œê³ ë¦¬ì¦˜)</h1>
<h3 id="ì •ë¦¬">ì •ë¦¬</h3>
<hr>
<ul>
<li><p>ë¬¸ì œëŠ” ì•„ë‹ˆì§€ë§Œ, ë’¤ì— ë‚˜ì˜¬ ë¬¸ì œì—ì„œ ì“°ì´ëŠ” ì•Œê³ ë¦¬ì¦˜ì´ê¸°ì— í•œë²ˆ ì •ë¦¬í•´ë´…ë‹ˆë‹¤.<br>
ì¹´ë¼ì¸ ë°”(Karatsuba)ëŠ” ëŸ¬ì‹œì•„ ì‚¬ëŒì´ê³ , ì´ ì•Œê³ ë¦¬ì¦˜ì€ ë‘ ê°œì˜ í° ì •ìˆ˜ë¥¼ ë¹ ë¥´ê²Œ ê³±í•˜ëŠ” ì•Œê³ ë¦¬ì¦˜ì…ë‹ˆë‹¤. ë³´í†µ 50ìë¦¬ ì´ìƒì˜ í° ìˆ˜ë“¤ì„ ë‹¤ë£° ë•Œ ì‚¬ìš©í•˜ëŠ” ê²ƒ ê°™ìŠµë‹ˆë‹¤.</p></li>
<li><p>ë¨¼ì € ë³´í†µì˜ í° ìˆ˜ë¥¼ ê³±í•˜ëŠ” ì•Œê³ ë¦¬ì¦˜ì„ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤. ë‘ ì •ìˆ˜ë¥¼ ì •ìˆ˜í˜• ë³€ìˆ˜ê°€ ì•„ë‹Œ <code class="hljs">ì •ìˆ˜í˜• ë°°ì—´</code>ì— <code class="hljs">ë’¤ì§‘ì–´ì„œ</code> ì €ì¥í•©ë‹ˆë‹¤. ë’¤ì§‘ì–´ì„œ ì €ì¥í•˜ë©´ ì¶œë ¥í•  ë•ŒëŠ” ë¶ˆí¸í•˜ì§€ë§Œ, ìë¦¿ìˆ˜ì˜ í¬ê¸°ë¥¼ ì§ê´€ì ìœ¼ë¡œ ë³¼ ìˆ˜ ìˆê¸°ì— í¸ë¦¬í•©ë‹ˆë‹¤. ë°°ì—´ì— ì €ì¥í•˜ëŠ” ê²ƒë„ ìë¦¿ìˆ˜ ì˜¬ë¦¼ì„ ì²˜ë¦¬í•˜ê¸° ìœ„í•¨ì…ë‹ˆë‹¤.</p></li>
</ul>
<pre class="cpp"><code class="hljs"><span class="hljs-comment">//num[]ì˜ ìë¦¿ìˆ˜ ì˜¬ë¦¼ì„ ì²˜ë¦¬</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">normalize</span><span class="hljs-params">(<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;&amp; num)</span></span>{
    num.push_back(<span class="hljs-number">0</span>);
    <span class="hljs-comment">//ìë¦¿ìˆ˜ ì˜¬ë¦¼ ì²˜ë¦¬ </span>
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>; i&lt;num.size(); i++){
        <span class="hljs-keyword">if</span>(num[i] &lt; <span class="hljs-number">0</span>){
            <span class="hljs-keyword">int</span> borrow = (<span class="hljs-built_in">abs</span>(num[i]) + <span class="hljs-number">9</span>) / <span class="hljs-number">10</span>;
            num[i+<span class="hljs-number">1</span>] -= borrow;
            num[i] += borrow * <span class="hljs-number">10</span>;
        }
        <span class="hljs-keyword">else</span> {
            num[i+<span class="hljs-number">1</span>] += num[i] / <span class="hljs-number">10</span>;
            num[i] %= <span class="hljs-number">10</span>;
        }
    }
    <span class="hljs-keyword">while</span>(num.size() &gt; <span class="hljs-number">1</span> &amp;&amp; num.back() == <span class="hljs-number">0</span>) num.pop_back();
}

<span class="hljs-comment">//ë‘ ê¸´ ìì—°ìˆ˜ì˜ ê³±</span>
<span class="hljs-comment">//ex) multiply([3,2,1],[6,5,4]) = 123 * 456 = 56088 = [8,8,0,6,5]</span>
<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; multiply(<span class="hljs-keyword">const</span> <span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;&amp; a, <span class="hljs-keyword">const</span> <span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;&amp; b){
    <span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; c(a.size() + b.size() +<span class="hljs-number">1</span>, <span class="hljs-number">0</span>);
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i=<span class="hljs-number">0</span>; i&lt;a.size(); i++){
        <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> j=<span class="hljs-number">0</span>; j&lt;b.size(); j++){
            c[i+j] += a[i] * b[j];
        }
    }
    normalize(c);
    <span class="hljs-keyword">return</span> c;
}</code></pre>
<ul>
<li>ì¹´ë¼ì¸ ë°”ì˜ ê³±ì…ˆì€ ë‘ ìˆ˜ë¥¼ ê°ê° ì ˆë°˜ìœ¼ë¡œ ìª¼ê°­ë‹ˆë‹¤. 258ìë¦¬ì˜ ë‘ ì •ìˆ˜ a,bë¼ í•˜ë©´ ë‹¤ìŒê³¼ ê°™ì´ ìª¼ê°œëŠ” ê²ƒì´ì£ .<br>
</li>
</ul>
<pre><code class="hljs">a = a1 * 10^128 + a0
b = b1 * 10^128 + b0</code></pre>
<ul>
<li>ë‘ ìˆ˜ë¥¼ ê³±í–ˆì„ ë•Œ ë‚˜ì˜¤ëŠ” ì„¸ ë¶€ë¶„ì„ ë‹¤ìŒê³¼ ê°™ì´ ì¹˜í™˜ì„ í•©ë‹ˆë‹¤.<br>
</li>
</ul>
<pre><code class="hljs markdown">a <span class="hljs-bullet">* b = (a1 *</span> b1) <span class="hljs-bullet">* 10^256 + (a1 *</span> b0 + a0 <span class="hljs-bullet">* b1) *</span> 10^128 + (a0 * b0)
<span class="hljs-bullet">-
</span>z2 = a1 * b1
z1 = a1 <span class="hljs-bullet">* b0 + a0 *</span> b1
z0 = a0 * b0</code></pre>
<p>ì—¬ê¸°ì„œ ë‹¤ìŒ ì‹ì„ ì´ìš©í•˜ë©´ z1ì„ z0ì™€ z2ë¡œ í‘œí˜„í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
<pre><code class="hljs markdown">(a0 + a1) <span class="hljs-bullet">* (b0 + b1) = (a0 *</span> b0) + (a1 <span class="hljs-bullet">* b0 + a0 + b1) + (a1 *</span> b1)
= z0 + z1 + z2</code></pre>
<pre><code class="hljs">z2 = a1 * b1
z0 = a0 * b0
z1 = (a0 + a1) * (b0 + b1) - z0 - z2</code></pre>
<ul>
<li>ì´ ê³¼ì •ì€ ê¸°ì¡´ì˜ ë°©ë²•ì´ ë„¤ ë²ˆì˜ ê³±ì…ˆì„ ì“°ëŠ” ê²ƒê³¼ ë‹¬ë¦¬ ì„¸ ë²ˆì˜ ê³±ì…ˆ ë°–ì— ì“°ì§€ ì•ŠìŠµë‹ˆë‹¤!<br>
ì´ ê²°ê³¼ë¥¼ ì¡°í•©í•˜ë©´ ì›ë˜ì˜ ë‹µì„ ë„ì¶œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</li>
</ul>
<h3 id="ì½”ë“œ">ì½”ë“œ</h3>
<hr>
<details>
<p></p><summary>ì½”ë“œ ë³´ê¸°</summary><p></p>
<p>ì‹¤ì œ êµ¬í˜„í•œ ì½”ë“œê°€ ì•„ë‹Œ ì˜ì‚¬ì½”ë“œì…ë‹ˆë‹¤.</p>
<pre class="cpp"><code class="hljs"><span class="hljs-comment">//a += b * (10^k);ë¥¼ êµ¬í˜„í•œë‹¤.</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">addTo</span><span class="hljs-params">(<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;&amp; a, <span class="hljs-keyword">const</span> <span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;&amp; b, <span class="hljs-keyword">int</span> k)</span></span>;
<span class="hljs-comment">//a -= b;ë¥¼ êµ¬í˜„í•œë‹¤. a &gt;= bë¥¼ ê°€ì •.</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">subFrom</span><span class="hljs-params">(<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;&amp; a, <span class="hljs-keyword">const</span> <span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;&amp; b)</span></span>;
<span class="hljs-comment">//ë‘ ê¸´ ì •ìˆ˜ì˜ ê³±ì„ ë°˜í™˜.</span>
<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; karatsuba(<span class="hljs-keyword">const</span> <span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;&amp; a, <span class="hljs-keyword">const</span> <span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;&amp; b){
    <span class="hljs-keyword">int</span> an = a.size(), bn = b.size();
    <span class="hljs-comment">//aê°€ bë³´ë‹¤ ì§§ì„ ê²½ìš° ë‘˜ì„ ë°”ê¾¼ë‹¤.</span>
    <span class="hljs-keyword">if</span>(an &lt; bn) <span class="hljs-keyword">return</span> karatsuba(b, a);
    <span class="hljs-comment">//base case : aë‚˜ bê°€ ë¹„ì–´ ìˆëŠ” ê²½ìš° </span>
    <span class="hljs-keyword">if</span>(an == <span class="hljs-number">0</span> || bn == <span class="hljs-number">0</span>) <span class="hljs-keyword">return</span> <span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;();
    <span class="hljs-comment">//base case : aê°€ ë¹„êµì  ì§§ì€ ê²½ìš° multiply(a, b)ë¡œ ê³„ì‚° </span>
    <span class="hljs-keyword">if</span>(an &lt;= <span class="hljs-number">50</span>) <span class="hljs-keyword">return</span> karatsuba(b, a);

    <span class="hljs-keyword">int</span> half = an / <span class="hljs-number">2</span>;
    <span class="hljs-comment">//aì™€ bë¥¼ ë°‘ì—ì„œ halfìë¦¬ì™€ ë‚˜ë¨¸ì§€ë¡œ ë¶„ë¦¬ </span>
    <span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; a0(a.begin(), a.begin() + half);
    <span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; a1(a.begin() + half, a.end());
    <span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; b0(b.begin(), b.begin() min&lt;<span class="hljs-keyword">int</span>&gt;(b.size(), half));
    <span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; b0(b.begin() min&lt;<span class="hljs-keyword">int</span>&gt;(b.size(), half), b.end());

    <span class="hljs-comment">//z2 = a1 * b1</span>
    <span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; z2 = karatsuba(a1, b1);
    <span class="hljs-comment">//z0 = a0 * b0</span>
    <span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; z0 = karatsuba(a0, b0);
    <span class="hljs-comment">//a0 = a0 + a1; b0 = b0 + b1;</span>
    addTo(a0, a1, <span class="hljs-number">0</span>); addTo(b0, b1, <span class="hljs-number">0</span>);
    <span class="hljs-comment">//z1 = (a0 * b0) - z0 - z2;</span>
    <span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; z1 = karatsuba(a0, b0);
    subFrom(z1, z0);
    subFrom(z1, z2);

    <span class="hljs-comment">//ret = z0 + z1 * 10^half + z2 * 10^(half * 2);</span>
    <span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt; ret;
    addTo(ret, z0, <span class="hljs-number">0</span>);
    addTo(ret, z1, half);
    addTo(ret, z2, half + half);
    <span class="hljs-keyword">return</span> ret;
}</code></pre>
</details>
</div></article><hr data-v-210f1d5a=""></div></div></p></div><script src="/js/chunk-vendors.708a92f7.js"></script><script src="/js/app.b8edd235.js"></script></body></html>