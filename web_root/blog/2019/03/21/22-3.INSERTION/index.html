<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"><link rel="icon" href="/favicon.ico" type="image/x-icon"><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/styles/default.min.css"><script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.8.0/highlight.min.js"></script><script>hljs.initHighlightingOnLoad();</script><title> | Luke's Note</title><link href="/css/app.b6923e53.css" rel="preload" as="style"><link href="/css/chunk-vendors.bad0137f.css" rel="preload" as="style"><link href="/js/app.1f2729ee.js" rel="preload" as="script"><link href="/js/chunk-vendors.79096a15.js" rel="preload" as="script"><link href="/css/chunk-vendors.bad0137f.css" rel="stylesheet"><link href="/css/app.b6923e53.css" rel="stylesheet"><meta charset="utf-8" data-vue-meta="true"><meta property="og:image" content="https://wbluke.com/img/about.f9a09115.jpeg" data-vmid="og:image" data-vue-meta="true"><meta property="og:title" content="22-3.INSERTION | Luke's Note" data-vmid="og:title" data-vue-meta="true"><meta property="og:description" content="Thank you for reading my article ğŸ¦Š" data-vmid="og:description" data-vue-meta="true"><script type="text/javascript" async="">var disqus_shortname  = "wbluke-com";
var disqus_title      = "22-3.INSERTION";
var disqus_identifier = "/2019/03/21/22-3.INSERTION/";
var disqus_url        = "http://wbluke.com/blog/2019/03/21/22-3.INSERTION/";
</script><script type="text/javascript" async="" src="//wbluke-com.disqus.com/embed.js"></script><link rel="preload" as="style" href="https://c.disquscdn.com/next/embed/styles/lounge.c268ed5d1c2c6bd5b044fe095da0a0c9.css"><link rel="preload" as="script" href="https://c.disquscdn.com/next/embed/common.bundle.7306fbb45608972e37b2d3948bc46a0b.js"><link rel="preload" as="script" href="https://c.disquscdn.com/next/embed/lounge.bundle.2e5bc2439403325e29d259632d7ebd62.js"><link rel="preload" as="script" href="https://disqus.com/next/config.js"><script src="https://c.disquscdn.com/next/embed/alfalfa_min.d078e4f2a4721192a99e02601a767617.js" async="" charset="UTF-8"></script></head><body><noscript></noscript><div id="app"><div id="site-title"><a href="/" class="page_title router-link-active"><h1><img id="site-logo" src="/img/favicon.4eb5b8a7.png" width="24" height="24">
        Luke's Note
      </h1></a></div><div class="menu effect"><ul><li><a href="/" class="router-link-active">About</a></li><li><a href="/blog/" class="router-link-active">Blog</a></li><li><a href="/insight/" class="">Insight</a></li></ul></div><p><div data-v-19a37fe7="" id="blog"><div data-v-19a37fe7="" id="blog-contents"><article data-v-19a37fe7=""><div data-v-19a37fe7="" class="inner-title-container"><h1 data-v-19a37fe7=""><a data-v-19a37fe7="" href="http://wbluke.com/blog/2019/03/21/22-3.INSERTION/" id="inner-title">[ì•Œê³ ë¦¬ì¦˜] 22-3. INSERTION (ì‚½ì… ì •ë ¬ ë’¤ì§‘ê¸°)</a></h1><p data-v-19a37fe7="" class="meta">2019. 03. 21. </p></div><div data-v-19a37fe7="" id="article-content"><h1 id="ì•Œê³ ë¦¬ì¦˜-22-3.-insertion-ì‚½ì…-ì •ë ¬-ë’¤ì§‘ê¸°" style="display: none;">[ì•Œê³ ë¦¬ì¦˜] 22-3. INSERTION (ì‚½ì… ì •ë ¬ ë’¤ì§‘ê¸°)</h1>
<h3 id="ë¬¸ì œ">ë¬¸ì œ</h3>
<hr>
<details>
<p></p><summary>ë¬¸ì œ ë³´ê¸°</summary><p></p>
<p><a href="https://algospot.com/judge/problem/read/INSERTION">Algospot Link : INSERTION</a></p>
<p><strong>ë¬¸ì œ</strong></p>
<p>ìœ ëª…í•œ ì •ë ¬ ì•Œê³ ë¦¬ì¦˜ì¸ ì‚½ì… ì •ë ¬ì€ ì •ë ¬ëœ ë¶€ë¶„ ë°°ì—´ì„ ìœ ì§€í•˜ë©° ì´ ë°°ì—´ì— ìƒˆ ì›ì†Œë¥¼ ì‚½ì…í•´ ë‚˜ê°€ëŠ” ì‹ìœ¼ë¡œ ë™ì‘í•©ë‹ˆë‹¤. ì£¼ì–´ì§„ ì •ìˆ˜ ë°°ì—´ Aë¥¼ ì •ë ¬í•˜ëŠ” ì‚½ì… ì •ë ¬ì˜ êµ¬í˜„ì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.</p>
<pre class="cpp"><code class="hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">insertionSort</span><span class="hljs-params">(<span class="hljs-built_in">vector</span>&lt;<span class="hljs-keyword">int</span>&gt;&amp; A)</span> </span>{
  <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; A.size(); ++i) {
    <span class="hljs-comment">// A[0..i-1] ì— A[i] ë¥¼ ë¼ì›Œë„£ëŠ”ë‹¤</span>
    <span class="hljs-keyword">int</span> j = i;
    <span class="hljs-keyword">while</span>(j &gt; <span class="hljs-number">0</span> &amp;&amp; A[j<span class="hljs-number">-1</span>] &gt; A[j]) {
      <span class="hljs-comment">// ë¶ˆë³€ì‹ a: A[j+1..i] ì˜ ëª¨ë“  ì›ì†ŒëŠ” A[j] ë³´ë‹¤ í¬ë‹¤.</span>
      <span class="hljs-comment">// ë¶ˆë³€ì‹ b: A[0..i] êµ¬ê°„ì€ A[j] ë¥¼ ì œì™¸í•˜ë©´ ì •ë ¬ë˜ì–´ ìˆë‹¤.</span>
      swap(A[j<span class="hljs-number">-1</span>], A[j]);
      --j;
    }
  }
}</code></pre>
<p>ì‚½ì… ì •ë ¬ì€ <code class="hljs css"><span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[0..i-1]</span></code> ì´ ì •ë ¬ëœ ë°°ì—´ì¼ ë•Œ, <code class="hljs css"><span class="hljs-selector-tag">A</span><span class="hljs-selector-attr">[i]</span></code> ë¥¼ ì ì ˆí•œ ìœ„ì¹˜ë¥¼ ë§Œë‚  ë•Œê¹Œì§€ ì™¼ìª½ìœ¼ë¡œ í•œì¹¸ì”© ì›€ì§ì…ë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´ <code class="hljs">A={5,1,4,3,2}</code> ì˜ ì‚½ì… ì •ë ¬ì€ ë‹¤ìŒê³¼ ê°™ì´ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤.</p>
<table>
<thead>
<tr class="header">
<th style="text-align: left;">A</th>
<th style="text-align: left;">ë¹„ê³ </th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">5 1 4 3 2</td>
<td style="text-align: left;">ì´ˆê¸° ìƒíƒœ</td>
</tr>
<tr class="even">
<td style="text-align: left;">1 5 4 3 2</td>
<td style="text-align: left;">1ì„ ì™¼ìª½ìœ¼ë¡œ 1ì¹¸ ì˜®ê¹€</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1 4 5 3 2</td>
<td style="text-align: left;">4ë¥¼ ì™¼ìª½ìœ¼ë¡œ 1ì¹¸ ì˜®ê¹€</td>
</tr>
<tr class="even">
<td style="text-align: left;">1 3 4 5 2</td>
<td style="text-align: left;">3ì„ ì™¼ìª½ìœ¼ë¡œ 2ì¹¸ ì˜®ê¹€</td>
</tr>
<tr class="odd">
<td style="text-align: left;">1 2 3 4 5</td>
<td style="text-align: left;">2ë¥¼ ì™¼ìª½ìœ¼ë¡œ 3ì¹¸ ì˜®ê¹€</td>
</tr>
</tbody>
</table>
<p>1ë¶€í„° Nê¹Œì§€ì˜ ìì—°ìˆ˜ê°€ í•œ ë²ˆì”© í¬í•¨ëœ ê¸¸ì´ N ì¸ ìˆ˜ì—´ A[] ë¥¼ ì‚½ì… ì •ë ¬í–ˆìŠµë‹ˆë‹¤. ì›ë˜ ìˆ˜ì—´ì€ ì•Œ ìˆ˜ ì—†ì§€ë§Œ, ê·¸ ê³¼ì •ì—ì„œ ê° ì›ì†Œê°€ ì™¼ìª½ìœ¼ë¡œ ëª‡ ì¹¸ì´ë‚˜ ì´ë™í–ˆëŠ”ì§€ë¥¼ ì•Œê³  ìˆìŠµë‹ˆë‹¤. ì˜ˆë¥¼ ë“¤ì–´, ìœ„ ì˜ˆì œì—ì„œ ê° ìœ„ì¹˜ì— ìˆëŠ” ê°’ë“¤ì´ ì›€ì§ì¸ ì¹¸ìˆ˜ë¥¼ í‘œí˜„í•˜ë©´ <code class="hljs">{0,1,1,2,3}</code> ì´ ë©ë‹ˆë‹¤. ì´ ë•Œ ì›ë˜ ìˆ˜ì—´ì„ ì°¾ì•„ë‚´ëŠ” í”„ë¡œê·¸ë¨ì„ ì‘ì„±í•˜ì„¸ìš”.</p>
<p><strong>ì…ë ¥</strong></p>
<p>ì…ë ¥ì˜ ì²« ì¤„ì—ëŠ” í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ì˜ ìˆ˜ <code class="hljs">C (1 &lt;= C &lt;= 50)</code> ê°€ ì£¼ì–´ì§‘ë‹ˆë‹¤. ê° í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ì˜ ì²« ì¤„ì—ëŠ” ì› ë°°ì—´ì˜ ê¸¸ì´ <code class="hljs">N (1 &lt;= N &lt;= 50000)</code> ì´ ì£¼ì–´ì§‘ë‹ˆë‹¤. ê·¸ ë‹¤ìŒ ì¤„ì— N ê°œì˜ ì •ìˆ˜ë¡œ Aì˜ ê° ìœ„ì¹˜ì— ìˆë˜ ê°’ë“¤ì´ ì›€ì§ì¸ ì¹¸ìˆ˜ê°€ ì£¼ì–´ì§‘ë‹ˆë‹¤. A ëŠ” 1ë¶€í„° N ê¹Œì§€ì˜ ì •ìˆ˜ë¥¼ í•œ ë²ˆì”© í¬í•¨í•©ë‹ˆë‹¤.</p>
<p>ì…ë ¥ì˜ ì–‘ì´ ë§ìœ¼ë¯€ë¡œ ê°€ëŠ¥í•œ ë¹ ë¥¸ ì…ë ¥ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.</p>
<p><strong>ì¶œë ¥</strong></p>
<p>ê° í…ŒìŠ¤íŠ¸ ì¼€ì´ìŠ¤ë§ˆë‹¤ ì¬êµ¬ì„±í•œ A[] ë¥¼ í•œ ì¤„ì— ì¶œë ¥í•©ë‹ˆë‹¤.</p>
<p><strong>ì˜ˆì œ ì…ë ¥</strong></p>
<pre><code class="hljs">2
5
0 1 1 2 3
4
0 1 2 3</code></pre>
<p><strong>ì˜ˆì œ ì¶œë ¥</strong></p>
<pre><code class="hljs">5 1 4 3 2
4 3 2 1</code></pre>
</details>
<h3 id="ì •ë¦¬">ì •ë¦¬</h3>
<hr>
<ul>
<li><p>ì†ìœ¼ë¡œ ì˜ˆì œë¥¼ í’€ë‹¤ë³´ë©´, ì£¼ì–´ì§„ ë°°ì—´ì„ ë’¤ì—ì„œë¶€í„° ì ‘ê·¼í•´ì•¼ í•œë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ì˜ˆì œì—ì„œ ë§ˆì§€ë§‰ ìˆ«ìì¸ A[4]ëŠ” 3ì¹¸ ì™¼ìª½ìœ¼ë¡œ ì›€ì§ì…ë‹ˆë‹¤. ì´ëŠ” 1ë¶€í„° 5ê¹Œì§€ì˜ ìˆ«ì ì¤‘ A[4]ë³´ë‹¤ í° ìˆ«ìê°€ 3ê°œ ìˆë‹¤ëŠ” ëœ»ì…ë‹ˆë‹¤. ë”°ë¼ì„œ í•´ë‹¹ ìë¦¬ì— ë“¤ì–´ê°ˆ ìˆ«ìëŠ” 2ê°€ ë©ë‹ˆë‹¤.<br>
ì´ì œ ì™¼ìª½ìœ¼ë¡œ í•œ ì¹¸ ê°€ì„œ ìƒê°í•´ë³´ë©´, A[3]ì€ ì´ë¯¸ ìë¦¬ë¥¼ ì°¾ì€ 2ë¥¼ ë¹¼ê³  ë‚˜ë¨¸ì§€ ìˆ«ì ë„¤ ê°œ ì¤‘ A[3]ë³´ë‹¤ í° ìˆ«ìê°€ ëª‡ ê°œì¸ì§€ë¥¼ ì˜ë¯¸í•©ë‹ˆë‹¤. ì´ëŸ° ì‹ìœ¼ë¡œ ë’¤ìª½ì—ì„œë¶€í„° í•˜ë‚˜ì”© ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ìˆë‹¤ëŠ” ê²ƒì„ ê¹¨ë‹¬ìœ¼ë©´, ì´ì œ ìš°ë¦¬ì—ê²Œ í•„ìš”í•œ ê¸°ëŠ¥ì€ ì–´ë–¤ ìˆ˜ì˜ ë¬¶ìŒì´ ìˆì„ ë•Œ kë²ˆì§¸ ì›ì†Œê°€ ë¬´ì—‡ì¸ì§€ ì°¾ëŠ” ê²ƒì„ì„ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p></li>
<li><p>ì–´ë–¤ ì›ì†Œë“¤ ì¤‘ì—ì„œ kë²ˆì§¸ ì›ì†Œë¥¼ ì°¾ëŠ” ê¸°ëŠ¥ì€ ë³´í†µì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ì— ìˆëŠ” Tree êµ¬ì¡°ì—ëŠ” ì—†ëŠ” ê¸°ëŠ¥ì´ê¸° ë•Œë¬¸ì—, <a href="https://wbluke.com/blog/2019/03/20/22-2.Treap%EC%9D%98_%EA%B5%AC%ED%98%84/">ì €ë²ˆ ì•„í‹°í´ì—ì„œ ì•Œì•„ë³¸ Treap</a>ì„ êµ¬í˜„í•˜ì—¬ ì´ ë¬¸ì œë¥¼ í•´ê²°í•´ ë´…ì‹œë‹¤.</p></li>
<li><p>ë¨¼ì € ì£¼ì–´ì§€ëŠ” ì…ë ¥ì´ ë§ìœ¼ë¯€ë¡œ Scanner ëŒ€ì‹  BufferedReaderë¡œ ì…ë ¥ì„ ì²˜ë¦¬í•´ì¤ë‹ˆë‹¤. ì „ì²´ ì½”ë“œê°€ ê¸¸ì§€ë§Œ ê±°ì˜ Treapì„ êµ¬í˜„í•œ ë©”ì†Œë“œë“¤ì´ê³ , ì‹¤ì œ ë¬¸ì œ í•´ê²°ì„ ìœ„í•œ ë©”ì†Œë“œëŠ” ë§¨ ë°‘ì— solve() í•˜ë‚˜ì´ë‹ˆ ì°¸ê³ í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.<br>
ë¨¼ì € ìˆ«ì 1ë¶€í„° nê¹Œì§€ì˜ keyë“¤ì„ ê°€ì§€ëŠ” Treapì„ ìƒì„±í•´ì¤ë‹ˆë‹¤. ê·¸ë¦¬ê³  ìœ„ì—ì„œ ì„¤ëª…í•œ ê·¸ëŒ€ë¡œ, ì…ë ¥ìœ¼ë¡œ ì£¼ì–´ì§„ ë°°ì—´ì„ ë’¤ì—ì„œë¶€í„° í•˜ë‚˜ì”© ì½ê³  kth() ë©”ì†Œë“œë¡œ í•´ë‹¹ ë…¸ë“œë¥¼ ì°¾ì€ í›„ì—, ë‹µì´ ë  ë°°ì—´ì— ë„£ì–´ì¤ë‹ˆë‹¤. ë„£ì–´ì¤€ ë…¸ë“œëŠ” ë‹¤ìŒ ë‹¨ê³„ë¥¼ ìœ„í•´ ê¸°ì¡´ Treapì—ì„œ ì œê±°í•´ì¤ë‹ˆë‹¤.</p></li>
</ul>
<h3 id="ì½”ë“œ">ì½”ë“œ</h3>
<hr>
<details>
<p></p><summary>ì½”ë“œ ë³´ê¸°</summary><p></p>
<p><a href="https://github.com/wbluke/Algorithm_PS/blob/master/src/CH22/INSERTION.java">Github Link</a></p>
<pre class="java"><code class="hljs"><span class="hljs-comment">/* INSERTION.java */</span>

<span class="hljs-keyword">import</span> java.io.BufferedReader;
<span class="hljs-keyword">import</span> java.io.IOException;
<span class="hljs-keyword">import</span> java.io.InputStreamReader;

<span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">INSERTION</span> </span>{

    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span>[] shifted = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">50000</span>];
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> n;
    <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span>[] A = <span class="hljs-keyword">new</span> <span class="hljs-keyword">int</span>[<span class="hljs-number">50000</span>];

    <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">TreapNode</span> </span>{
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> key;
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">double</span> priority;
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">int</span> size;
        <span class="hljs-keyword">private</span> TreapNode left, right;

        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">TreapNode</span><span class="hljs-params">(<span class="hljs-keyword">int</span> key)</span> </span>{
            <span class="hljs-keyword">this</span>.key = key;
            priority = Math.random();
            size = <span class="hljs-number">1</span>;
        }

        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setLeft</span><span class="hljs-params">(TreapNode newNode)</span> </span>{
            left = newNode;
            calcSize();
        }

        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">setRight</span><span class="hljs-params">(TreapNode newNode)</span> </span>{
            right = newNode;
            calcSize();
        }

        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">calcSize</span><span class="hljs-params">()</span> </span>{
            size = <span class="hljs-number">1</span>;
            <span class="hljs-keyword">if</span> (left != <span class="hljs-keyword">null</span>) size += left.size;
            <span class="hljs-keyword">if</span> (right != <span class="hljs-keyword">null</span>) size += right.size;
        }
    }

    <span class="hljs-keyword">public</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Pair</span>&lt;<span class="hljs-title">L</span>, <span class="hljs-title">R</span>&gt; </span>{

        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> L left;
        <span class="hljs-keyword">private</span> <span class="hljs-keyword">final</span> R right;

        <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-title">Pair</span><span class="hljs-params">(L left, R right)</span> </span>{
            <span class="hljs-keyword">this</span>.left = left;
            <span class="hljs-keyword">this</span>.right = right;
        }

        <span class="hljs-function"><span class="hljs-keyword">public</span> L <span class="hljs-title">getLeft</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">return</span> left;
        }

        <span class="hljs-function"><span class="hljs-keyword">public</span> R <span class="hljs-title">getRight</span><span class="hljs-params">()</span> </span>{
            <span class="hljs-keyword">return</span> right;
        }
    }

    <span class="hljs-comment">// split root tree to two subTrees by key</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> Pair&lt;TreapNode, TreapNode&gt; <span class="hljs-title">split</span><span class="hljs-params">(TreapNode root, <span class="hljs-keyword">int</span> key)</span> </span>{
        <span class="hljs-keyword">if</span> (root == <span class="hljs-keyword">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Pair(<span class="hljs-keyword">null</span>, <span class="hljs-keyword">null</span>);

        <span class="hljs-comment">// split right subTree if root is less than key</span>
        <span class="hljs-keyword">if</span> (root.key &lt; key) {
            Pair&lt;TreapNode, TreapNode&gt; rs = split(root.right, key);
            root.setRight(rs.getLeft());
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Pair(root, rs.getRight());
        }

        <span class="hljs-comment">// split left subTree if root is greater than or equal to key</span>
        Pair&lt;TreapNode, TreapNode&gt; rs = split(root.left, key);
        root.setLeft(rs.getRight());
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> Pair(rs.getLeft(), root);
    }

    <span class="hljs-comment">// return root after inserting new node</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> TreapNode <span class="hljs-title">insert</span><span class="hljs-params">(TreapNode root, TreapNode node)</span> </span>{
        <span class="hljs-keyword">if</span> (root == <span class="hljs-keyword">null</span>) <span class="hljs-keyword">return</span> node;

        <span class="hljs-keyword">if</span> (root.priority &lt; node.priority) {
            Pair&lt;TreapNode, TreapNode&gt; splitted = split(root, node.key);
            node.setLeft(splitted.getLeft());
            node.setRight(splitted.getRight());
            <span class="hljs-keyword">return</span> node;
        } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (node.key &lt; root.key) {
            root.setLeft(insert(root.left, node));
        } <span class="hljs-keyword">else</span> {
            root.setRight(insert(root.right, node));
        }
        <span class="hljs-keyword">return</span> root;
    }

    <span class="hljs-comment">// merge two Treaps when max(a) &lt; min(b)</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> TreapNode <span class="hljs-title">merge</span><span class="hljs-params">(TreapNode a, TreapNode b)</span> </span>{
        <span class="hljs-keyword">if</span> (a == <span class="hljs-keyword">null</span>) <span class="hljs-keyword">return</span> b;
        <span class="hljs-keyword">if</span> (b == <span class="hljs-keyword">null</span>) <span class="hljs-keyword">return</span> a;
        <span class="hljs-keyword">if</span> (a.priority &lt; b.priority) {
            b.setLeft(merge(a, b.left));
            <span class="hljs-keyword">return</span> b;
        }
        a.setRight(merge(a.right, b));
        <span class="hljs-keyword">return</span> a;
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> TreapNode <span class="hljs-title">erase</span><span class="hljs-params">(TreapNode root, <span class="hljs-keyword">int</span> key)</span> </span>{
        <span class="hljs-keyword">if</span> (root == <span class="hljs-keyword">null</span>) <span class="hljs-keyword">return</span> root;

        <span class="hljs-keyword">if</span> (root.key == key) {
            TreapNode ret = merge(root.left, root.right);
            root = <span class="hljs-keyword">null</span>; <span class="hljs-comment">// will be erased by Garbage Collector later</span>
            <span class="hljs-keyword">return</span> ret;
        }
        <span class="hljs-keyword">if</span> (key &lt; root.key) {
            root.setLeft(erase(root.left, key));
        } <span class="hljs-keyword">else</span> {
            root.setRight(erase(root.right, key));
        }
        <span class="hljs-keyword">return</span> root;
    }

    <span class="hljs-comment">// return kth node</span>
    <span class="hljs-function"><span class="hljs-keyword">public</span> TreapNode <span class="hljs-title">kth</span><span class="hljs-params">(TreapNode root, <span class="hljs-keyword">int</span> k)</span> </span>{
        <span class="hljs-keyword">int</span> leftSize = <span class="hljs-number">0</span>;
        <span class="hljs-keyword">if</span> (root.left != <span class="hljs-keyword">null</span>) leftSize = root.left.size;
        <span class="hljs-keyword">if</span> (k &lt;= leftSize) <span class="hljs-keyword">return</span> kth(root.left, k);
        <span class="hljs-keyword">if</span> (k == leftSize + <span class="hljs-number">1</span>) <span class="hljs-keyword">return</span> root;
        <span class="hljs-keyword">return</span> kth(root.right, k - leftSize - <span class="hljs-number">1</span>);
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">int</span> <span class="hljs-title">countLessThan</span><span class="hljs-params">(TreapNode root, <span class="hljs-keyword">int</span> key)</span> </span>{
        <span class="hljs-keyword">if</span> (root == <span class="hljs-keyword">null</span>) <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;

        <span class="hljs-keyword">if</span> (key &lt;= root.key) <span class="hljs-keyword">return</span> countLessThan(root.left, key);
        <span class="hljs-keyword">int</span> ls = (root.left != <span class="hljs-keyword">null</span> ? root.left.size : <span class="hljs-number">0</span>);
        <span class="hljs-keyword">return</span> ls + <span class="hljs-number">1</span> + countLessThan(root.right, key);
    }

    <span class="hljs-comment">// =======================================================================</span>

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">void</span> <span class="hljs-title">solve</span><span class="hljs-params">()</span> </span>{
        <span class="hljs-comment">// make new Treap</span>
        TreapNode candidates = <span class="hljs-keyword">null</span>;
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; n; i++) {
            candidates = insert(candidates, <span class="hljs-keyword">new</span> TreapNode(i + <span class="hljs-number">1</span>));
        }

        <span class="hljs-comment">// fill A[] from behind</span>
        <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = n - <span class="hljs-number">1</span>; i &gt;= <span class="hljs-number">0</span> ; i--) {

            <span class="hljs-keyword">int</span> larger = shifted[i];
            TreapNode k = kth(candidates, i + <span class="hljs-number">1</span> - larger);
            A[i] = k.key;
            candidates = erase(candidates, k.key);
        }
    }

    <span class="hljs-function"><span class="hljs-keyword">public</span> <span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">main</span><span class="hljs-params">(String[] args)</span> <span class="hljs-keyword">throws</span> IOException </span>{
        BufferedReader br = <span class="hljs-keyword">new</span> BufferedReader(<span class="hljs-keyword">new</span> InputStreamReader(System.in));

        <span class="hljs-keyword">int</span> loop = Integer.parseInt(br.readLine());
        <span class="hljs-keyword">while</span> (loop-- &gt; <span class="hljs-number">0</span>) {
            INSERTION insertion = <span class="hljs-keyword">new</span> INSERTION();

            insertion.n = Integer.parseInt(br.readLine());
            String[] input = br.readLine().split(<span class="hljs-string">" "</span>);
            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; insertion.n; i++) {
                insertion.shifted[i] = Integer.parseInt(input[i]);
            }

            insertion.solve();

            <span class="hljs-keyword">for</span> (<span class="hljs-keyword">int</span> i = <span class="hljs-number">0</span>; i &lt; insertion.n; i++) {
                System.out.print(insertion.A[i] + <span class="hljs-string">" "</span>);
            }
            System.out.println();
        }
    }
}
</code></pre>
</details>
</div></article><hr data-v-19a37fe7=""><div data-v-19a37fe7="" id="disqus_thread"><iframe id="dsq-app7425" name="dsq-app7425" allowtransparency="true" frameborder="0" scrolling="no" tabindex="0" title="Disqus" width="100%" src="https://disqus.com/embed/comments/?base=default&amp;f=wbluke-com&amp;t_i=%2F2019%2F03%2F21%2F22-3.INSERTION%2F&amp;t_u=http%3A%2F%2Fwbluke.com%2Fblog%2F2019%2F03%2F21%2F22-3.INSERTION%2F&amp;t_e=22-3.INSERTION&amp;t_d=%0A%20%20%20%20%20%20%20%20Luke's%20Note%0A%20%20%20%20%20%20&amp;t_t=22-3.INSERTION&amp;s_o=default#version=8a1796648b4a0ed90950910fbd4dbdb6" style="width: 1px !important; min-width: 100% !important; border: none !important; overflow: hidden !important; height: 390px !important;" horizontalscrolling="no" verticalscrolling="no"></iframe></div></div></div></p></div><script src="/js/chunk-vendors.79096a15.js"></script><script src="/js/app.1f2729ee.js"></script><iframe style="display: none;"></iframe></body></html>